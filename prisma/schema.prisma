generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model Level {
  id               String   @id @default(cuid())
  date             String   @unique // YYYY-MM-DD format
  gridWidth        Int      @default(10)
  gridHeight       Int      @default(10)
  laserConfig      String   // JSON: { x, y, direction }
  obstacles        String   // JSON: [{ x, y }]
  mirrorsAvailable Int      @default(5)
  starThresholds   String   // JSON: [oneStar, twoStar, threeStar]
  optimalScore     Int      // Maximum possible score for this level
  optimalSolution  String?  // JSON: [{ x, y, type }] - cached optimal mirror placement
  createdAt        DateTime @default(now())

  submissions ScoreSubmission[]
}

model ScoreSubmission {
  id        String   @id @default(cuid())
  levelId   String
  level     Level    @relation(fields: [levelId], references: [id], onDelete: Cascade)
  playerId  String
  score     Int
  createdAt DateTime @default(now())

  @@unique([levelId, playerId])
  @@index([levelId, score])
}

